<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
    <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>
            Wedding Apps || Souvenir Book
        </title>
        <meta content="" name="description">
        <meta content="" name="author">
        <meta content="" name="keywords">
        <meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport">
        <!-- Birdman v1.0 || ex nihilo || April 2015 -->
        <!-- style start -->
        <link href="<?php echo base_url(); ?>main_assets/home_asset/css/bootstrap.min.css" media="all" rel="stylesheet" type="text/css">
        <link href="<?php echo base_url(); ?>main_assets/home_asset/css/style-dark.css" media="all" rel="stylesheet" type="text/css">
        <link href="<?php echo base_url(); ?>main_assets/home_asset/css/flexslider.css" media="all" rel="stylesheet" type="text/css">
        <link href="<?php echo base_url(); ?>main_assets/home_asset/datatables/jquery.dataTables.min.css" media="all" rel="stylesheet" type="text/css">
        <link href="<?php echo base_url(); ?>main_assets/home_asset/css/font-awesome-4.3.0/css/font-awesome.css" media="all" rel="stylesheet" type="text/css"><!-- style end -->
        <link rel="stylesheet" href="<?php echo base_url(); ?>main_assets/home_asset/package/dist/sweetalert2.css">
        <!-- google fonts start -->
        <link href=
              "https://fonts.googleapis.com/css?family=Raleway:100,200,300,400,500,600,700,800,900|Oswald:300,400,700|Dosis:200,300,400,500,600,700,800|Open+Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"
              rel="stylesheet" type="text/css"><!-- google fonts end -->
        <!-- alternate style start || to use your preferred color, simply remove all style colors below and leave only your preferred color -->
        <link href="css/colors/white-dark.css" media="screen" rel="stylesheet" title="white" type="text/css">
        <!--[if lt IE 9]>
             <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
         <![endif]-->
    </head>
    <body>
        <!-- screen loader start -->
        <div class="screen-loader"></div><!-- screen loader end -->
        <!-- preload start -->
        <div id="preload">
            <!-- preload status start -->
            <div id="preload-status"></div><!-- preload status end -->
        </div><!-- preload end -->
        <!-- kenburnsy bg start -->
        <div id="kenburnsy-bg">
            <img alt="Background" src="<?php echo base_url(); ?>main_assets/home_asset/images/background/TOM05217.jpg">
            <img alt="Background" src="<?php echo base_url(); ?>main_assets/home_asset/images/background/TOM05636.jpg">
            <img alt="Background" src="<?php echo base_url(); ?>main_assets/home_asset/images/background/TOM05638.jpg">
        </div><!-- kenburnsy bg end -->
        <!-- curtains start -->
        <div id="curtains"></div><!-- curtains end -->
        <!-- top shade start -->
        <div id="top-shade"></div><!-- top shade end -->
        <!-- preload content start -->
        <div class="preload-content"></div><!-- preload content end -->
        <!-- birds start -->
        <div id="birdman-container"></div>
        <div id="birdman-holder">
            <canvas></canvas>
        </div><!-- birds end -->
        <!-- navigation start -->
        <div class="menu btn-nav">
            <a href="#"><span></span></a>
        </div>
        <nav role="navigation">
            <ul class="main-nav brackets">
                <li>
                    <a class="menu-state" href="" onclick="goto()" >LOGOUT</a>
                </li>
            </ul>
        </nav><!-- navigation end -->
        <!-- upper page start -->
        <div class="upper-page current" id="home">
            <!-- center container start -->
            <div class="center-container-home">
                <!-- center block start -->
                <div class="center-block">
                    <!-- square start -->
                    <div class="square">
                        <span class="l1"></span>
                        <span class="l2"></span>
                        <span class="l3"></span>
                        <span class="l4"></span>
                    </div><!-- square end -->
                    <!-- upper content start -->
                    <div class="upper-content">
                        <!-- container start -->
                        <div class="container sections">
                            <div class="text-center" >
                                <img src="<?php echo base_url(); ?>main_assets/home_asset/images/background/logo_1.png" width="650px">
                            </div>
                            <!-- row start -->
                            <div class="row intro-down">
                                <div class="cycle-it-home">
                                    <a class="cycle-text">Souvenir Book</a>
                                </div>
                                <!-- intro start -->                               
                                <div id="intro-wrapper">
                                    <br><br><br>                          
                                    <!-- newsletter form start -->
                                    <div id="subscribe-wrapper">
                                        <div id="newsletter">
                                            <div class="newsletter">
                                                <form id="ajax" action="" method="post" enctype="multipart/form-data">
                                                    <span class="input input--kuro">
                                                        <input class="subscriberequiredField subscribeemail input__field input__field--kuro" id="barcode" name="barcode" type="text">
                                                        <label class="input__label input__label--kuro" for="input-7">
                                                            <span class="mail input__label-content input__label-content--kuro">
                                                                <b>INPUT BARCODE</b>
                                                            </span>
                                                        </label> 
                                                        <button class="submit-button" id="submit" type="submit">CONFIRM</button></span>
                                                </form>
                                            </div>
                                        </div>
                                    </div><!-- newsletter form end -->
                                </div><!-- intro end -->
                                <br>
                                <br>
                                <div class="cycle-it-home">
                                    <h5>
                                        "Bagi kalian Allah menciptakan pasangan-pasangan (istri-istri) dari jenis kalian sendiri, kemudian dari istri-istri kalian itu Dia ciptakan bagi kalian anak cucu keturunan, dan kepada kalian Dia berikan rezeki yang baik-baik."<br> <b>(QS. An Nahl (16):72)<b></b>.
                                    </h5>
                                </div>
                            </div><!-- row end -->                           
                        </div><!-- container end -->
                        <!-- countdown start -->
                        <!-- countdown start -->
                        <div id="countdown-wrapper">
                            <ul id="countdown">
                                <!-- days start -->
                                <li>
                                    <span class="days">00</span>
                                    <p class="timeRefDays">
                                        Check In 
                                    </p>
                                </li><!-- days end -->
                                <!-- seconds start -->
                                <li>
                                    <span class="seconds">00</span>
                                    <p class="timeRefSeconds">
                                        Check Out
                                    </p>
                                </li><!-- seconds end -->
                            </ul>
                        </div><!-- countdown end -->
                    </div><!-- center container end -->
                </div><!-- center block end -->
            </div><!-- upper content end -->
        </div><!-- upper page end -->  
        <div id="myModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title text-danger" id="myModalLabel"><b>List Absen Undangan Group </b></h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                    </div>
                    <form class="form-horizontal" action="<?php echo site_url('ktp/upload_csv'); ?>" enctype="multipart/form-data" method="post">
                        <div class="modal-body">                  
                            <div class="card">
                                <div class="card-body">                                   
                                    <div class="table-responsive m-t-40">
                                        <table id="myTables" class="table table-bordered table-striped">
                                            <thead>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Barcode</th>                        
                                                    <th>Nama Undangan</th> 
                                                    <th>Asal</th>  
                                                    <th>Souvenir</th>  
                                                    <th>Aksi</th> 
                                                </tr>
                                            </thead>
                                            <tfoot>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Barcode</th>                        
                                                    <th>Nama Undangan</th>  
                                                    <th>Asal</th>  
                                                    <th>Souvenir</th>
                                                    <th>Aksi</th> 
                                                </tr>
                                            </tfoot>
                                            <tbody>
                                                <?php
                                                if (!empty($hadir)) {
                                                    $i = 1;
                                                    foreach ($hadir as $key => $value) {
                                                        ?> 
                                                        <tr>
                                                            <td><?php echo $i; ?><span</td>
                                                            <td><b><?php echo ucwords($value->barcode); ?></b></td> 
                                                            <td><?php echo ucwords($value->nama_tamu); ?></td>    
                                                            <td><?php echo $value->asal_tamu; ?></td>
                                                            <td>
                                                                <?php if ($value->souvenir == 1) {
                                                                    ?>
                                                                    <span class="label label-danger"><b>Belum Terpakai</b></span>
                                                                <?php } else { ?>
                                                                    <span class="label label-success"><b>Terpakai</b></span>
                                                                <?php } ?>
                                                            </td>
                                                            <td>
                                                                <?php if ($value->souvenir == 1) { ?>
                                                                    <button type="button" id="edit" value="<?php echo $value->id . "," . $value->barcode; ?>" class="btn btn-info btn-sm btn-icon btn-pure btn-outline delete-row-btn " data-toggle="tooltip" data-original-title="Absen">Ambil</button>
                                                                <?php } else { ?>
                                                                    <span class="label label-success"><b>Diambil</b></span>
                                                                <?php } ?>
                                                            </td>
                                                        </tr>
                                                        <?php
                                                        $i++;
                                                    }  //ngatur nomor urut
                                                }
                                                ?>         
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">                           
                            <button type="button" class="btn btn-default waves-effect" data-dismiss="modal">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- scripts start -->
        <script src="<?php echo base_url(); ?>main_assets/home_asset/js/jquery-1.11.2.min.js" type="text/javascript"></script>
        <script src="<?php echo base_url(); ?>main_assets/home_asset/js/plugins-dark.js" type="text/javascript"></script>
        <script src="<?php echo base_url(); ?>main_assets/home_asset/js/birdman.js" type="text/javascript"></script>
        <script src="<?php echo base_url(); ?>main_assets/home_asset/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="<?php echo base_url(); ?>main_assets/home_asset/package/dist/sweetalert2.min.js"></script>
        <script src="<?php echo base_url(); ?>main_assets/home_asset/datatables/jquery.dataTables.min.js"></script>

        <!-- scripts end -->
        <script>
                        $('#myTables').DataTable();
                        function goto() {
                            document.location = "<?php echo site_url('auth/logout'); ?>";
                        }
                        setInterval(function () {
                            window.location.reload();
                        }, 300000);
        </script>
        <script>
            update_content()
            $(document).ready(function (e) {
                var refresher = setInterval("update_content();", 10000); // 30 seconds
            })

            function update_content() {
                $.ajax({
                    type: "GET",
                    url: "<?php echo site_url('dashboard/get_data'); ?>",
                    cache: false,
                    success: function (result) {
                        var arr = result.split(',');
                        if (arr[0] == 1) {
                            $('span.days').text(arr[1]);
                            $('span.seconds').text(arr[2]);
                        }
                    },
                    error: function (result) {

                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            html: 'Mohon Maaf.., sistem sedang <b>TIDAK ADA KONEKSI</b>!',
                            footer: 'Mohon maaf atas ketidaknyamanya'
                        });
                    }
                });

            }
        </script>
        <script>
            $(document).ready(function () {
                $("#submit").click(function () {
                    var barcode = $("#barcode").val();
// Returns successful data submission message when the entered information is stored in database.
                    var dataString = 'barcode=' + barcode;
// AJAX Code To Submit Form.
                    $.ajax({
                        type: "POST",
                        url: "<?php echo site_url('dashboard/cek_barcode_souvenir'); ?>",
                        data: dataString,
                        cache: false,
                        success: function (result) {
                            var arrays = result.split(',');

                            if (arrays[0] == 1) {
                                Swal.fire({
                                    title: 'Terima Kasih Atas Kehadiranya',
                                    html: 'an: <b>"' + arrays[1] + '"</b>',
                                    icon: 'info',
                                    showCancelButton: true,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Ambil souvenir, Ya!',
                                    cancelButtonText: 'Batal',
                                    footer: 'Semoga Selamat Sampai Tujuan'
                                }).then((result) => {
                                    if (result.value) {
                                        var dataString = 'status=' + '0' + '&barcode=' + barcode;
                                        $.ajax({
                                            type: "POST",
                                            url: "<?php echo site_url('dashboard/ubah_status_souvenir'); ?>",
                                            data: dataString,
                                            cache: false,
                                            success: function (result) {

                                                if (result == 0) {
                                                    Swal.fire({
                                                        icon: 'error',
                                                        title: 'Oops...',
                                                        html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> tidak ditemukan!',
                                                        footer: 'Silahkan dicek kembali barcode Anda'
                                                    });
                                                } else if (result == 1) {
                                                    Swal.fire(
                                                            'Berhasil!',
                                                            'Abesensi souvenir undangan telah diupdate.',
                                                            'success'
                                                            )
                                                }
                                            },
                                            error: function (result) {
                                                Swal.fire({
                                                    icon: 'error',
                                                    title: 'Oops...',
                                                    html: 'Mohon Maaf.., sistem sedang <b>ERROR</b>!',
                                                    footer: 'Mohon maaf atas ketidaknyamanya'
                                                });
                                            }
                                        });
                                    }
                                })
                            } else if (arrays[0] == 0) {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Oops...',
                                    html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> tidak ditemukan!',
                                    footer: 'Silahkan dicek kembali barcode Anda'
                                });
                            } else if (arrays[0] == 2) {
                                Swal.fire({
                                    icon: 'warning',
                                    title: 'Pemberitahuan...',
                                    html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> dengan Atas Nama:<br><b>' + arrays[1] + '</b> <br><br> Telah Mengambil Souvenir',
                                    footer: 'Silahkan dicek kembali barcode Anda'
                                });
                            } else if (arrays[0] == 3) {
                                Swal.fire({
                                    icon: 'warning',
                                    title: 'Pemberitahuan...',
                                    html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> dengan status Undangan Group:<br><b>' + arrays[1] + '</b> <br><br>Memiliki Kuota Souvenir<b>0</b>, silahkan edit kuota souvenir group',
                                    footer: '<a style="color:blue;" href="<?php echo site_url('dashboard/list_undangan_grup'); ?>"><b>Tambah Kuota Undangan</b></a>'
                                });
                            } else if (arrays[0] == 4) {

                                Swal.fire({
                                    icon: 'warning',
                                    title: 'Pemberitahuan...',
                                    showCancelButton: true,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Ambil souvenir, Ya!',
                                    cancelButtonText: 'Batal',
                                    html: 'Barcode <b>' + barcode + '</b> dengan status Undangan Group:<br><b>' + arrays[1] + '</b> <br><br>Memiliki Sisa Kuota: <br><b>' + arrays[2] + ' Souvenir</b> <br><br> Silahkan Ambil Souvenir.',
                                    footer: '<a style="color:blue;" href="<?php echo site_url('dashboard/list_undangan_grup'); ?>"><b>Lihat Souvenir Group</b></a>',
                                    focusConfirm: false,
                                    preConfirm: () => {
                                        $('#myModal').modal('show');
                                    }
                                })
                            } else if (arrays[0] == 5) {
                                Swal.fire({
                                    title: 'Terima Kasih Atas Kehadiranya',
                                    html: 'an: <b>"' + arrays[1] + '"</b>',
                                    icon: 'info',
                                    showCancelButton: true,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Ambil souvenir, Ya!',
                                    cancelButtonText: 'Batal',
                                    footer: 'Semoga Selamat Sampai Tujuan'
                                }).then((result) => {
                                    if (result.value) {
                                        var dataString = 'status=' + '0' + '&barcode=' + barcode;
                                        $.ajax({
                                            type: "POST",
                                            url: "<?php echo site_url('dashboard/ubah_status_souvenir'); ?>",
                                            data: dataString,
                                            cache: false,
                                            success: function (result) {

                                                if (result == 0) {
                                                    Swal.fire({
                                                        icon: 'error',
                                                        title: 'Oops...',
                                                        html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> tidak ditemukan!',
                                                        footer: 'Silahkan dicek kembali barcode Anda'
                                                    });
                                                } else if (result == 1) {
                                                    Swal.fire(
                                                            'Berhasil!',
                                                            'Abesensi souvenir undangan telah diupdate.',
                                                            'success'
                                                            )
                                                }
                                            },
                                            error: function (result) {
                                                Swal.fire({
                                                    icon: 'error',
                                                    title: 'Oops...',
                                                    html: 'Mohon Maaf.., sistem sedang <b>ERROR</b>!',
                                                    footer: 'Mohon maaf atas ketidaknyamanya'
                                                });
                                            }
                                        });
                                    }
                                })
                            } else if (arrays[0] == 6) {
                                Swal.fire({
                                    icon: 'warning',
                                    title: 'Pemberitahuan...',
                                    html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> dengan Atas Nama:<br><b>' + arrays[1] + '</b> <br><br> Belum Absen Buku Tamu/Undangan',
                                    footer: 'Silahkan absen di buku tamu terlebih dahulu'});
                            }
                        },
                        error: function (result) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                html: 'Mohon Maaf.., sistem sedang <b>ERROR</b>!',
                                footer: 'Mohon maaf atas ketidaknyamanya'
                            });
                        }
                    });
                    return false;
                });

                $("#edit").click(function () {
                    var id = $("#edit").val();
                    var arrayss = id.split(',');
// Returns successful data submission message when the entered information is stored in database.
                    var dataString = 'id=' + arrayss[0] + '&barcode=' + arrayss[1] + '&status=' + '1';

// AJAX Code To Submit Form.
                    $.ajax({
                        type: "POST",
                        url: "<?php echo site_url('dashboard/ubah_status_souvenir_group'); ?>",
                        data: dataString,
                        cache: false,
                        success: function (result) {
                            if (result == 0) {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Oops...',
                                    html: 'Mohon Maaf.., Barcode <b>' + barcode + '</b> tidak ditemukan!',
                                    footer: 'Silahkan dicek kembali barcode Anda'
                                });
                            } else if (result == 1) {
                                $('#myModal').modal('hide');
                                Swal.fire(
                                        'Berhasil!',
                                        'Absensi souvenir undangan group telah ditambahkan.',
                                        'success'
                                        )
                                location.reload();
                            }
                        },
                        error: function (result) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                html: 'Mohon Maaf.., sistem sedang <b>ERROR</b>!',
                                footer: 'Mohon maaf atas ketidaknyamanya'
                            });
                        }
                    });
                    return false;
                });
            });
        </script>
    </body>
</html>